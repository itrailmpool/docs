# Berkeley DB 4.8
Oracle Linux использует "Berkeley DB" для предоставления функциональности базы данных, которая необходима для Bitcoin Core. Эта библиотека представлена в пакетах libdb и libdb-devel. Но Bitcoin Core требуется версия этой библиотеки 4.8, в то время как в репозитории Oracle Linux может быть более новая версия, что может вызвать проблемы.

Нужно вручную скомпилировать и установить версию Berkeley DB 4.8:
### 1. Загрузите исходный код Berkeley DB 4.8:
```sh
wget http://download.oracle.com/berkeley-db/db-4.8.30.NC.tar.gz
```
### 2. Распакуйте архив и перейдите в директорию с исходным кодом:
```sh
tar -xvf db-4.8.30.NC.tar.gz
```
### 3. Исправление конфликта имен в Berkeley DB для успешной компиляции:
```sh
sed s/__atomic_compare_exchange/__atomic_compare_exchange_db/g -i db-4.8.30.NC/dbinc/atomic.h
```
### 4. Создайте каталог для установки:
```sh
mkdir -p /opt/db-4.8.30.NC/
```
### 5. Сконфигурируйте и установите Berkeley DB 4.8
Команда `../dist/configure` выполняет скрипт, который подготавливает исходный код для сборки на вашей системе.
```sh
cd db-4.8.30.NC/build_unix/
../dist/configure --enable-cxx --disable-shared --with-pic --prefix=/opt/db-4.8.30.NC
```

- `--enable-cxx` этот флаг включает поддержку C++.
- `--disable-shared` этот флаг отключает сборку shared libraries. Это значит, что все программы, которые будут собраны, будут статически связаны с библиотеками, которые они используют.
- `--with-pic` этот флаг включает создание "position-independent code" (PIC). PIC используется для создания shared libraries, которые могут быть загружены в произвольное место в адресном пространстве.
- `--prefix=/opt/db-4.8.30.NC` этот флаг указывает каталог, в который будут установлены все файлы после сборки. В данном случае, все файлы будут установлены в каталог /opt/db-4.8.30.NC.

Компиляция и сборка проекта:
```sh
make -j4
```
> Note: Опция -j сообщает make, сколько заданий (jobs) можно выполнять одновременно. В нашем случае есть процессор с 4 ядрами, make -j4 позволит использовать все ядра, чтобы ускорить процесс сборки.
```sh
sudo make install
```
### 6. Очистка
Удалите загруженные файлы, они больше не понадобятся:
```sh
cd ~
rm -rf db-4.8.30.NC*
```
Дополнительно можно удалить загруженную документацию Berkeley DB (78 Mb):
```sh
rm -rf /opt/db-4.8.30.NC/docs
```
